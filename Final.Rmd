---
title: "Powerlifting"
author: "Jared Pearson" 
date: "2023-04-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

Powerlifting is a sport that requires immense physical and mental strength, and as a powerlifter, I have wondered about things like differences in strength between sexes, which weight class has the strongest lifters, or age which age group is the strongest. Through this data science project, I aim to explore these questions and others to explore some insights into the powerlifting community. 

questions
What is the distribution of lifters between weight classes and how does this vary by sex?

How much does equipment change how you perform?

How do lifters perform in the different divisions?

Which weight classes have the strongest strength ratio?

How do weight ratios differ between the sexes?

# Load tidyverse for data manipulation
# Load ggplot for plotting
```{r}
library(tidyverse)
library(ggplot2)
library(knitr)
library(dplyr)

```


# Raw unfiltered data
This data set is from github and it was created by Nichole Monhait. The data comes from open powerlifting which is a website dedicated to compiling powerlifting data from federations around the world.
```{r}
ipf_lifts <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-08/ipf_lifts.csv")
```

```{r}
glimpse(ipf_lifts)
```

#data cleaning

```{r}

invalid_divisions <- c("Heavy","Light","Middle","Super","SuperHeavy")

ipf_lifts$division <- as.character(ipf_lifts$division)

ipf_lifts <- subset(ipf_lifts, !(division %in% invalid_divisions))

ipf_lifts$division <- as.factor(ipf_lifts$division)
levels(ipf_lifts$division)

```
```{r}
ipf_lifts$best3squat_kg <- ifelse(is.na(ipf_lifts$best3squat_kg), 0, ipf_lifts$best3squat_kg)

ipf_lifts$best3bench_kg <- ifelse(is.na(ipf_lifts$best3bench_kg), 0, ipf_lifts$best3bench_kg)

ipf_lifts$best3deadlift_kg <- ifelse(is.na(ipf_lifts$best3deadlift_kg), 0, ipf_lifts$best3deadlift_kg)
```

```{r}

ipf_lifts$division <- replace(ipf_lifts$division, is.na(ipf_lifts$division), "Open")
```

```{r}
ipf_lifts <- ipf_lifts%>%
  filter(!is.na(bodyweight_kg))

ipf_lifts <- ipf_lifts%>%
  filter(!is.na(age))
```

#take a look at filtered data

```{r}
glimpse(ipf_lifts)
```


There are few key terms to note before going forward


Equipment: Equipment refers to what the lifter is wearing. Sinlgle ply usually means a special supportive lifting suits or shirts designed for certain lifts and most likely knee wraps for squat and Raw means a non-supportive singlet and knee sleeves for squat.


Division: This refers to certain age groups or category the lifter can choose to participate in. If a lifter falls within a certain age they can choose to compete in the class for that age otherwise they compete in no division and compete in the default which is usually just open. 


1. How do lifters perform in the different divisions.
 
 # As a table 
 
```{r}
division_lifts <- ipf_lifts %>%
  group_by(division) %>%
  summarise(avg_squat = mean(best3squat_kg[best3squat_kg != 0]),
            avg_bench = mean(best3bench_kg[best3bench_kg != 0]),
            avg_deadlift = mean(best3deadlift_kg[best3deadlift_kg != 0]),
            avg_total = sum(avg_squat,avg_bench,avg_deadlift))

division_lifts
```

 # As a graph
 
```{r}
division_lifts %>%
  ggplot(aes(x=division, y=avg_squat)) +
  geom_col()
  
division_lifts %>%
  ggplot(aes(x=division, y=avg_bench)) +
  geom_col()

division_lifts %>%
  ggplot(aes(x=division, y=avg_deadlift)) +
  geom_col()

division_lifts %>%
  ggplot(aes(x=division, y=avg_total)) +
  geom_col()
```


```{r}
ipf_lifts%>%
  na.omit()%>%
  group_by(division)%>%
  summarise(avg_squat_ratio = mean(best3squat_kg/bodyweight_kg),
            avg_bench_ratio = mean(best3bench_kg/bodyweight_kg),
            avg_deadlift_ratio = mean(best3deadlift_kg/bodyweight_kg),
            avg_total_ratio = mean((best3squat_kg+best3bench_kg+best3deadlift_kg)/bodyweight_kg))

```

#as weight ratios
```{r}
division_ratios <- ipf_lifts %>%
  group_by(division) %>%
  summarise(avg_squat_ratio = mean(best3squat_kg[best3squat_kg != 0])/mean(bodyweight_kg),
            avg_bench_ratio = mean(best3bench_kg[best3bench_kg != 0])/mean(bodyweight_kg),
            avg_deadlift_ratio = mean(best3deadlift_kg[best3deadlift_kg != 0])/mean(bodyweight_kg),
            avg_total_ratio = sum(avg_squat_ratio,avg_bench_ratio,avg_deadlift_ratio))

division_ratios
```


```{r}
division_ratios%>%
  ggplot(aes(x=division, y=avg_squat_ratio)) +
  geom_col()
  
division_ratios %>%
  ggplot(aes(x=division, y=avg_bench_ratio)) +
  geom_col()

division_ratios %>%
  ggplot(aes(x=division, y=avg_deadlift_ratio)) +
  geom_col()

division_ratios %>%
  ggplot(aes(x=division, y=avg_total_ratio))+
  geom_col()
```


2. What is the distribution of lifters by weight class


```{r}

```

```{r}
  
```

```{r}

 
```




3.How much does equipment change how you perform?
```{r}

```


4.Which weight classes have the strongest strength ratio?
```{r}

```


5.How do weight ratios differ between the sexes?
```{r}

```

